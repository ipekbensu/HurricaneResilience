<html>
<head>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <style>
        * {
            box-sizing: border-box;
        }
        .column{
            float: left;
            width: 50%;
            padding: 0px;
        }
        .row:after{
            content: "";
            display: table;
            clear: both;
        }
    </style>
    <!-- data -->
    <script src="./data.js"></script>
    <script src="./dataNatural.js"></script>
    <script src="./dataBuilt.js"></script>
    <script src="./dataSocial.js"></script>
    <!-- functions -->
    <script src="./functions.js"></script>
    <script src="./run.js"></script>
    <!-- mapping -->
    <script src="https://maps.google.com/maps/api/js?sensor=false&key=AIzaSyARxs_0QWBQzZ-7tnFIkcz6Tzh5Fr1I0xg"></script>
</head>
<body>
    <!-- mapping -->
    <h1>Vulnerability</h1>
    <div class="row">
        <div class="column">
            <h2>Map:</h2>
            <p>Displays scores.</p>
            <div id="map1" style="width: 600px; height: 600px"></div>
        </div>
        <div class="column">
            <h2>Select.</h2>
            <select id="dropdown" onchange="mark1Edit()">
                <option value="w">Vulnerability-------------------</option>
                <option value="w">Natural Hazard</option>
                <option value="w">Built Hazard</option>
                <option value="w">Social Hazard</option>
            </select>
            <h2>Text:</h2>
            <p>Explains method.</p>
            <h2>Reference:</h2>
            <p>Edit.</p>
        </div>
    </div>
</body>
<script>
    var map1 = []; // overall risk, each risk factor
    var mark1 = []; // affected by dropdown

    function mapsInit(){
        var options = {
            title: 'Florida',
            center: new google.maps.LatLng(27.8899385, -83.4083427),
            zoom: 6.54,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        map1 = new google.maps.Map(document.getElementById('map1'), options);
    };

    function mark1Init(){
        coord.data.forEach(function(county, countyIndex){
            var scale = null;
            var risk = null;
            if(scores.data[countyIndex][5] == 1){
                scale = 2.5;
                risk = 'Low';
            }
            if(scores.data[countyIndex][5] == 2){
                scale = 5;
                risk = 'Moderate';
            }
            if(scores.data[countyIndex][5] == 3){
                scale = 7.5;
                risk = 'High';
            }
            var info = 'Vulnerability: ' + risk;
            info += '\n' + "Natural Score: " + String(scores.data[countyIndex][2]);
            info += '\n' + "Built Score: " + String(scores.data[countyIndex][3]);
            info += '\n' + "Social Score: " + String(scores.data[countyIndex][4]);
            if(scale != null){
                var marker = new google.maps.Marker({
                    title: county[0] + '\n' + info,
                    map: map1,
                    position: new google.maps.LatLng(county[2], county[3]),
                    icon: {
                        path: google.maps.SymbolPath.CIRCLE,
                        scale: scale,
                        strokeColor: '#FF0000',
                        strokeOpacity: 0.8,
                        strokeWeight: 2,
                        fillColor: '#FF0000',
                        fillOpacity: 0.35
                    }
                });
                mark1.push(marker);
            }
        });
    };

    function mark1Edit(){ // called by dropdown
        mark1Clear();
        var selected = document.getElementById('dropdown');
        var res = selected.options[selected.selectedIndex].text;
        var scale = null;
        var risk = null;
        var info = null;
        coord.data.forEach(function(county, countyIndex){
            if(res == 'Vulnerability-------------------'){
                if(scores.data[countyIndex][5] == 1){
                    scale = 2.5;
                    risk = 'Low';
                }
                else{
                    if(scores.data[countyIndex][5] == 2){
                        scale = 5;
                        risk = 'Moderate';
                    }
                    else{
                        if(scores.data[countyIndex][5] == 3){
                            scale = 7.5;
                            risk = 'High';
                        }
                        else{
                            scale = null;
                            risk = null;
                        }
                    }
                }
                info = 'Vulnerability: ' + risk;
                info += '\n' + "Natural Score: " + String(scores.data[countyIndex][2]);
                info += '\n' + "Built Score: " + String(scores.data[countyIndex][3]);
                info += '\n' + "Social Score: " + String(scores.data[countyIndex][4]);
            };
            if(res == 'Natural Hazard'){
                if(scores.data[countyIndex][2] == 1){
                    scale = 2.5;
                    risk = 'Low';
                }
                else{
                    if(scores.data[countyIndex][2] == 2){
                        scale = 5;
                        risk = 'Moderate';
                    }
                    else{
                        if(scores.data[countyIndex][2] == 3){
                            scale = 7.5;
                            risk = 'High';
                        }
                        else{
                            scale = null;
                            risk = null;
                        }
                    }
                }
                info = 'Natural Risk: ' + risk;
            };
            if(res == 'Built Hazard'){
                if(scores.data[countyIndex][3] == 1){
                    scale = 2.5;
                    risk = 'Low';
                }
                else{
                    if(scores.data[countyIndex][3] == 2){
                        scale = 5;
                        risk = 'Moderate';
                    }
                    else{
                        if(scores.data[countyIndex][3] == 3){
                            scale = 7.5;
                            risk = 'High';
                        }
                        else{
                            scale = null;
                            risk = null;
                        }
                    }
                }
                info = 'Built Risk: ' + risk;
            };
            if(res == 'Social Hazard'){
                if(scores.data[countyIndex][4] == 1){
                    scale = 2.5;
                    risk = 'Low';
                }
                else{
                    if(scores.data[countyIndex][4] == 2){
                        scale = 5;
                        risk = 'Moderate';
                    }
                    else{
                        if(scores.data[countyIndex][4] == 3){
                            scale = 7.5;
                            risk = 'High';
                        }
                        else{
                            scale = null;
                            risk = null;
                        }
                    }
                }
                info = 'Social Risk: ' + risk;
            };
            if(scale != null){
                var marker = new google.maps.Marker({
                    title: county[0] + '\n' + info,
                    map: map1,
                    position: new google.maps.LatLng(county[2], county[3]),
                    icon: {
                        path: google.maps.SymbolPath.CIRCLE,
                        scale: scale,
                        strokeColor: '#FF0000',
                        strokeOpacity: 0.8,
                        strokeWeight: 2,
                        fillColor: '#FF0000',
                        fillOpacity: 0.35
                    }
                });
                mark1.push(marker);
            }
        });
    };

    function mark1Clear(){
        for(var i=0; i<mark1.length; i++){
            mark1[i].setMap(null);
        }
        mark1 = [];
    };

    function viewMap(){
        google.maps.event.addDomListener(window, 'load', mapsInit);
        google.maps.event.addDomListener(window, 'load', mark1Init);
    };
    viewMap();
</script>
</html>