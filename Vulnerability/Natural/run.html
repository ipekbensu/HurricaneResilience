<html>
<head>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <style>
        * {
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
            box-sizing: border-box;
        }
        .column{
            float: left;
            width: 50%;
        }
        .row:after{
            content: "";
            display: table;
            clear: both;
        }
    </style>
    <!-- data -->
    <script src="./data.js"></script>
    <!-- functions -->
    <script src="./functions.js"></script>
    <script src="./run.js"></script>
    <!-- mapping -->
    <script src="https://maps.google.com/maps/api/js?sensor=false&key=AIzaSyARxs_0QWBQzZ-7tnFIkcz6Tzh5Fr1I0xg"></script>
</head>
<body>
    <h2 style="text-align:center;">Hurricane Resilience</h2>
    <p style="text-align:center;">Mapping <a href="https://ipekbensu.github.io/HurricaneResilience/Vulnerability/run.html">vulnerability</a> and potential <a href="https://ipekbensu.github.io/HurricaneResilience/AmplifiedMorbidities/run.html">loss amplification</a></p>
    <br>
    <br>
    <h1 style="text-align:center;">Natural Hazard</h1>
    <div class="row">
        <div class="column" style="padding-left:50px;">
            <h2>Map:</h2>
            <p>A qualitative assessment.</p>
            <div id="map1" style="width: 550px; height: 600px"></div>
        </div>
        <div class="column" style="padding-right:50px;">
            <h2>Method:</h2>
            <p>For hurricanes, the primary risk factor is wind. The main measure of wind risk is windspeed maps. During assessment, windspeed maps were attained from ASCE 7-16 for "ordinary buildings" (ASCE 7-10 Risk Category II). A 700-year MRI was used. Areas expecting Saffir-Simpson Category III were categorized as "Low", Category IV as "Moderate and Category V as "High".</p>
            <p>Secondary risk factors include windborne debris and storm surge. These effects show up mostly on the coastline. Windborne debris maps were found through ASCE 7-16 and the Florida Building Code, storm surge maps through NOAA. Saffir-Simpson categories for 700-year MRI were used for inspection.</p>
            <p>Windborne debris and storm surge were assigned lower importance factors while aggregating natural risk.</p>
            <a href="https://ipekbensu.github.io/HurricaneResilience/Vulnerability/run.html">Bigger Picture.</a>
            <h2>Reference:</h2>
            <h3>Method:</h3>
            <p>NIBS, 2018. "Mitigation Saves."<br>
            DBPR, 2017. "Florida Building Code."</p>
            <h3>Data:</h3>
            <p><a href="https://asce7hazardtool.online/">ASCE</a>.<br>
            <a href="https://hazards.atcouncil.org/">ATC</a>.<br>
            <a href="https://www.nhc.noaa.gov/nationalsurge/">NOAA</a>.</p>
        </div>
    </div>
    <br>
    <br>
    <h1 style="text-align:center;">Breakdown:</h1>
    <div class="row">
        <div class="column" style="padding-left:50px;">
            <h2>Map:</h2>
            <p>A qualitative assessment.</p>
            <div id="map2" style="width: 550px; height: 600px"></div>
        </div>
        <div class="column" style="padding-right:50px;">
            <h2>Select risk factor.</h2>
            <select id="dropdown" onchange="mark2Edit()">
                <option value="w">Wind----------------------------</option>
                <option value="d">Windborne Debris</option>
                <option value="s">Storm Surge</option>
            </select>
            <h2>Method:</h2>
            <p id="method">The main measure of wind risk is windspeed maps. During assessment, windspeed maps were attained from ASCE 7-16 for "ordinary buildings" (ASCE 7-10 Risk Category II). A 700-year MRI was used. Areas expecting Saffir-Simpson Category III were classified as "Low", Category IV as "Moderate" and Category V as "High".</p>
            <h2>Reference:</h2>
            <h3>Method:</h3>
            <p id="mref">NIBS, 2018. "Mitigation Saves."</p>
            <h3>Data:</h3>
            <p id="dref"><a href="https://asce7hazardtool.online/">ASCE</a>.<br>
            <a href="https://hazards.atcouncil.org/">ATC</a>.</p>
        </div>
    </div>
</body>
<script>
    var map1 = []; // overall risk
    var map2 = []; // each risk factor
    var mark1 = [];
    var mark2 = []; // affected by dropdown

    function mapsInit(){
        var options = {
            title: 'Florida',
            center: new google.maps.LatLng(27.8899385, -83.4083427),
            zoom: 6.54,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        map1 = new google.maps.Map(document.getElementById('map1'), options);
        map2 = new google.maps.Map(document.getElementById('map2'), options);
    };

    function mark1Init(){
        coord.data.forEach(function(county, countyIndex){
            var scale = null;
            var risk = null;
            if(scores.data[countyIndex][5] == 1){
                scale = 2.5;
                risk = 'Low';
            }
            if(scores.data[countyIndex][5] == 2){
                scale = 5;
                risk = 'Moderate';
            }
            if(scores.data[countyIndex][5] == 3){
                scale = 7.5;
                risk = 'High';
            }
            var info = 'Natural Risk: ' + risk;
            info += '\n' + "Wind Score: " + String(scores.data[countyIndex][2]);
            info += '\n' + "Windborne Debris Score: " + String(scores.data[countyIndex][3]);
            info += '\n' + "Storm Surge Score: " + String(scores.data[countyIndex][4]);
            if(scale != null){
                var marker = new google.maps.Marker({
                    title: county[0] + '\n' + info,
                    map: map1,
                    position: new google.maps.LatLng(county[2], county[3]),
                    icon: {
                        path: google.maps.SymbolPath.CIRCLE,
                        scale: scale,
                        strokeColor: '#FF0000',
                        strokeOpacity: 0.8,
                        strokeWeight: 2,
                        fillColor: '#FF0000',
                        fillOpacity: 0.35
                    }
                });
                mark1.push(marker);
            }
        });
    };

    function mark2Init(){
        coord.data.forEach(function(county, countyIndex){
            var scale = null;
            var risk = null;
            if(scores.data[countyIndex][2] == 1){
                scale = 2.5;
                risk = 'Low';
            }
            if(scores.data[countyIndex][2] == 2){
                scale = 5;
                risk = 'Moderate';
            }
            if(scores.data[countyIndex][2] == 3){
                scale = 7.5;
                risk = 'High';
            }
            if(scale != null){
                var marker = new google.maps.Marker({
                    title: county[0] + '\n' + 'Wind Risk: ' + risk,
                    map: map2,
                    position: new google.maps.LatLng(county[2], county[3]),
                    icon: {
                        path: google.maps.SymbolPath.CIRCLE,
                        scale: scale,
                        strokeColor: '#FF0000',
                        strokeOpacity: 0.8,
                        strokeWeight: 2,
                        fillColor: '#FF0000',
                        fillOpacity: 0.35
                    }
                });
                mark2.push(marker);
            }
        });
    };

    function mark2Edit(){ // called by dropdown
        mark2Clear();
        var selected = document.getElementById('dropdown');
        var res = selected.options[selected.selectedIndex].text;
        var scale = null;
        var risk = null;
        var info = null;
        coord.data.forEach(function(county, countyIndex){
            if(res == 'Wind----------------------------'){
                document.getElementById('method').innerHTML = 'The main measure of wind risk is windspeed maps. During assessment, windspeed maps were attained from ASCE 7-16 for "ordinary buildings" (ASCE 7-10 Risk Category II). A 700-year MRI was used. Areas expecting Saffir-Simpson Category III were classified as "Low", Category IV as "Moderate" and Category V as "High".';
                document.getElementById('mref').innerHTML = 'NIBS, 2018. "Mitigation Saves."';
                document.getElementById('dref').innerHTML = '<a href="https://asce7hazardtool.online/">ASCE</a>.<br><a href="https://hazards.atcouncil.org/">ATC</a>.';
                if(scores.data[countyIndex][2] == 1){
                    scale = 2.5;
                    risk = 'Low';
                }
                else{
                    if(scores.data[countyIndex][2] == 2){
                        scale = 5;
                        risk = 'Moderate';
                    }
                    else{
                        if(scores.data[countyIndex][2] == 3){
                            scale = 7.5;
                            risk = 'High';
                        }
                        else{
                            scale = null;
                            risk = null;
                        }
                    }
                }
                info = 'Wind Risk: ' + risk;
            };
            if(res == 'Windborne Debris'){
                document.getElementById('method').innerHTML = 'Windborne debris is a seconary effect that shows up mostly on the coastline. During assessment, windspeed maps were attained from ASCE 7-16 for 700-year MRI. Windborne debris maps were found through ASCE 7-16 and the Florida Building Code. Saffir-Simpson categories were used for inspection.';
                document.getElementById('mref').innerHTML = 'NIBS, 2018. "Mitigation Saves."<br>DBPR, 2017. "Florida Building Code."';
                document.getElementById('dref').innerHTML = '<a href="https://asce7hazardtool.online/">ASCE</a>.<br><a href="https://hazards.atcouncil.org/">ATC</a>.';
                if(scores.data[countyIndex][3] == 1){
                    scale = 2.5;
                    risk = 'Low';
                }
                else{
                    if(scores.data[countyIndex][3] == 2){
                        scale = 5;
                        risk = 'Moderate';
                    }
                    else{
                        if(scores.data[countyIndex][3] == 3){
                            scale = 7.5;
                            risk = 'High';
                        }
                        else{
                            scale = null;
                            risk = null;
                        }
                    }
                }
                info = 'Windborne Debris Risk: ' + risk;
            };
            if(res == 'Storm Surge'){
                document.getElementById('method').innerHTML = 'Storm surge is a seconary effect that shows up mostly on the coastline. During assessment, windspeed maps were attained from ASCE 7-16 for 700-year MRI. Storm surge maps were found through NOAA. Saffir-Simpson categories were used for inspection.';
                document.getElementById('mref').innerHTML = 'NIBS, 2018. "Mitigation Saves."';
                document.getElementById('dref').innerHTML = '<a href="https://asce7hazardtool.online/">ASCE</a>.<br><a href="https://hazards.atcouncil.org/">ATC</a>.<br><a href="https://www.nhc.noaa.gov/nationalsurge/">NOAA</a>.';
                if(scores.data[countyIndex][4] == 1){
                    scale = 2.5;
                    risk = 'Low';
                }
                else{
                    if(scores.data[countyIndex][4] == 2){
                        scale = 5;
                        risk = 'Moderate';
                    }
                    else{
                        if(scores.data[countyIndex][4] == 3){
                            scale = 7.5;
                            risk = 'High';
                        }
                        else{
                            scale = null;
                            risk = null;
                        }
                    }
                }
                info = 'Storm Surge Risk: ' + risk;
            };
            if(scale != null){
                var marker = new google.maps.Marker({
                    title: county[0] + '\n' + info,
                    map: map2,
                    position: new google.maps.LatLng(county[2], county[3]),
                    icon: {
                        path: google.maps.SymbolPath.CIRCLE,
                        scale: scale,
                        strokeColor: '#FF0000',
                        strokeOpacity: 0.8,
                        strokeWeight: 2,
                        fillColor: '#FF0000',
                        fillOpacity: 0.35
                    }
                });
                mark2.push(marker);
            }
        });
    };

    function mark2Clear(){
        for(var i=0; i<mark2.length; i++){
            mark2[i].setMap(null);
        }
        mark2 = [];
    };

    function viewMap(){
        google.maps.event.addDomListener(window, 'load', mapsInit);
        google.maps.event.addDomListener(window, 'load', mark1Init);
        google.maps.event.addDomListener(window, 'load', mark2Init);
    };
    viewMap();
</script>
</html>