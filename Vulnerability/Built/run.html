<html>
<head>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <style>
        * {
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
            box-sizing: border-box;
        }
        .column{
            float: left;
            width: 50%;
        }
        .row:after{
            content: "";
            display: table;
            clear: both;
        }
    </style>
    <!-- data -->
    <script src="./data.js"></script>
    <script src="./NCHSURCodes2013.js"></script>
    <script src="./Demographics.js"></script>
    <!-- functions -->
    <script src="./functions.js"></script>
    <script src="./run.js"></script>
    <!-- mapping -->
    <script src="https://maps.google.com/maps/api/js?sensor=false&key=AIzaSyARxs_0QWBQzZ-7tnFIkcz6Tzh5Fr1I0xg"></script>
</head>
<body>
    <h2 style="text-align:center;">Hurricane Resilience</h2>
    <p style="text-align:center;">Mapping <a href="https://ipekbensu.github.io/HurricaneResilience/Vulnerability/run.html">vulnerability</a> and potential <a href="https://ipekbensu.github.io/HurricaneResilience/AmplifiedMorbidities/run.html">loss amplification</a></p>
    <br>
    <br>
    <h1 style="text-align:center;">Built Hazard</h1>
    <div class="row">
        <div class="column" style="padding-left:50px;">
            <h2>Map:</h2>
            <p>A qualitative assessment.</p>
            <div id="map1" style="width: 550px; height: 600px"></div>
        </div>
        <div class="column" style="padding-right:50px;">
            <h2>Method:</h2>
            <p>One primary risk factor is the density of the building stock. Urban areas are more susceptible to high levels of post-event damage. County categories were attained from CDC. Non-metro areas were classified as "No Risk", small metros are "Low", medium metros are "Moderate" and large metros as "High".</p>
            <p>Another primary risk factor is the age of the building stock. Older buildings are prone to greater structural damage. Age distributions were extracted from HAZUS. Since stricter codes were enforced after the 1992 Hurricane Andrew, areas with a majority of building built after 1990 were classified as "No Risk", before 1990 as "Low", before 1980 as "Moderate" and before 1970 as "High".</p>
            <p>Density and age were assigned equal importance factors while aggregating built risk.</p>
            <a href="https://ipekbensu.github.io/HurricaneResilience/Vulnerability/run.html">Back.</a>
            <h2>Reference:</h2>
            <h3>Method:</h3>
            <p>Sutley, 2017. "Community-Level Framework for Seismic Resilience."<br>
            HRSA, 2016. "List of Rural Counties."</p>
            <h3>Data:</h3>
            <p><a href="https://www.cdc.gov/nchs/data_access/urban_rural.htm">CDC</a>.<br>
            FEMA. HAZUS Tool.</p>
        </div>
    </div>
    <br>
    <br>
    <h1 style="text-align:center;">Breakdown:</h1>
    <div class="row">
        <div class="column" style="padding-left:50px;">
            <h2>Map:</h2>
            <p>A qualitative assessment.</p>
            <div id="map2" style="width: 550px; height: 600px"></div>
        </div>
        <div class="column" style="padding-right:50px;">
            <h2>Select risk factor.</h2>
            <select id="dropdown" onchange="mark2Edit()">
                <option value="w">Density (Rural/Urban)-----------</option>
                <option value="d">Age (Old/New)</option>
            </select>
            <h2>Method:</h2>
            <p id="method">Urban areas are more susceptible to high levels of post-event damage. County categories were attained from CDC. Non-metro areas were classified as "No Risk", small metros are "Low", medium metros are "Moderate" and large metros as "High".</p>
            <h2>Reference:</h2>
            <h3>Method:</h3>
            <p id="mref">Sutley, 2017. "Community-Level Framework for Seismic Resilience."<br>
            HRSA, 2016. "List of Rural Counties."</p>
            <h3>Data:</h3>
            <p id="dref"><a href="https://www.cdc.gov/nchs/data_access/urban_rural.htm">CDC</a>.</p>
        </div>
    </div>
</body>
<script>
    var map1 = []; // over risk
    var map2 = []; // each risk factor
    var mark1 = [];
    var mark2 = []; // affected by dropdown

    function mapsInit(){
        var options = {
            title: 'Florida',
            center: new google.maps.LatLng(27.8899385, -83.4083427),
            zoom: 6.54,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        map1 = new google.maps.Map(document.getElementById('map1'), options);
        map2 = new google.maps.Map(document.getElementById('map2'), options);
    };

    function mark1Init(){
        coord.data.forEach(function(county, countyIndex){
            var scale = null;
            var risk = null;
            if(scores.data[countyIndex][4] == 1){
                scale = 2.5;
                risk = 'Low';
            }
            if(scores.data[countyIndex][4] == 2){
                scale = 5;
                risk = 'Moderate';
            }
            if(scores.data[countyIndex][4] == 3){
                scale = 7.5;
                risk = 'High';
            }
            var info = 'Built Risk: ' + risk;
            info += '\n' + "Density Score: " + String(scores.data[countyIndex][2]);
            info += '\n' + "Age Score: " + String(scores.data[countyIndex][3]);
            if(scale != null){
                var marker = new google.maps.Marker({
                    title: county[0] + '\n' + info,
                    map: map1,
                    position: new google.maps.LatLng(county[2], county[3]),
                    icon: {
                        path: google.maps.SymbolPath.CIRCLE,
                        scale: scale,
                        strokeColor: '#FF0000',
                        strokeOpacity: 0.8,
                        strokeWeight: 2,
                        fillColor: '#FF0000',
                        fillOpacity: 0.35
                    }
                });
                mark1.push(marker);
            }
        });
    };

    function mark2Init(){
        coord.data.forEach(function(county, countyIndex){
            var scale = null;
            var risk = null;
            if(scores.data[countyIndex][2] == 1){
                scale = 2.5;
                risk = 'Low';
            }
            if(scores.data[countyIndex][2] == 2){
                scale = 5;
                risk = 'Moderate';
            }
            if(scores.data[countyIndex][2] == 3){
                scale = 7.5;
                risk = 'High';
            }
            if(scale != null){
                var marker = new google.maps.Marker({
                    title: county[0] + '\n' + 'Density Risk: ' + risk,
                    map: map2,
                    position: new google.maps.LatLng(county[2], county[3]),
                    icon: {
                        path: google.maps.SymbolPath.CIRCLE,
                        scale: scale,
                        strokeColor: '#FF0000',
                        strokeOpacity: 0.8,
                        strokeWeight: 2,
                        fillColor: '#FF0000',
                        fillOpacity: 0.35
                    }
                });
                mark2.push(marker);
            }
        });
    };

    function mark2Edit(){ // called by dropdown
        mark2Clear();
        var selected = document.getElementById('dropdown');
        var res = selected.options[selected.selectedIndex].text;
        var scale = null;
        var risk = null;
        var info = null;
        coord.data.forEach(function(county, countyIndex){
            if(res == 'Density (Rural/Urban)-----------'){
                document.getElementById('method').innerHTML = 'Urban areas are more susceptible to high levels of post-event damage. County categories were attained from CDC. Non-metro areas were classified as "No Risk", small metros are "Low", medium metros are "Moderate" and large metros as "High".';
                document.getElementById('mref').innerHTML = 'Sutley, 2017. "Community-Level Framework for Seismic Resilience."<br>HRSA, 2016. "List of Rural Counties."';
                document.getElementById('dref').innerHTML = '<a href="https://www.cdc.gov/nchs/data_access/urban_rural.htm">CDC</a>.';
                if(scores.data[countyIndex][2] == 1){
                    scale = 2.5;
                    risk = 'Low';
                }
                else{
                    if(scores.data[countyIndex][2] == 2){
                        scale = 5;
                        risk = 'Moderate';
                    }
                    else{
                        if(scores.data[countyIndex][2] == 3){
                            scale = 7.5;
                            risk = 'High';
                        }
                        else{
                            scale = null;
                            risk = null;
                        }
                    }
                }
                info = 'Density Risk: ' + risk;
            };
            if(res == 'Age (Old/New)'){
                document.getElementById('method').innerHTML = 'Older buildings are prone to greater structural damage. Age distributions were extracted from HAZUS. Since stricter codes were enforced after the 1992 Hurricane Andrew, areas with a majority of building built after 1990 were classified as "No Risk", before 1990 as "Low", before 1980 as "Moderate" and before 1970 as "High".';
                document.getElementById('mref').innerHTML = 'Sutley, 2017. "Community-Level Framework for Seismic Resilience."';
                document.getElementById('dref').innerHTML = 'FEMA. HAZUS Tool.';
                if(scores.data[countyIndex][3] == 1){
                    scale = 2.5;
                    risk = 'Low';
                }
                else{
                    if(scores.data[countyIndex][3] == 2){
                        scale = 5;
                        risk = 'Moderate';
                    }
                    else{
                        if(scores.data[countyIndex][3] == 3){
                            scale = 7.5;
                            risk = 'High';
                        }
                        else{
                            scale = null;
                            risk = null;
                        }
                    }
                }
                info = 'Age Risk: ' + risk;
            };
            if(scale != null){
                var marker = new google.maps.Marker({
                    title: county[0] + '\n' + info,
                    map: map2,
                    position: new google.maps.LatLng(county[2], county[3]),
                    icon: {
                        path: google.maps.SymbolPath.CIRCLE,
                        scale: scale,
                        strokeColor: '#FF0000',
                        strokeOpacity: 0.8,
                        strokeWeight: 2,
                        fillColor: '#FF0000',
                        fillOpacity: 0.35
                    }
                });
                mark2.push(marker);
            }
        });
    };

    function mark2Clear(){
        for(var i=0; i<mark2.length; i++){
            mark2[i].setMap(null);
        }
        mark2 = [];
    };

    function viewMap(){
        google.maps.event.addDomListener(window, 'load', mapsInit);
        google.maps.event.addDomListener(window, 'load', mark1Init);
        google.maps.event.addDomListener(window, 'load', mark2Init);
    };
    viewMap();
</script>
</html>